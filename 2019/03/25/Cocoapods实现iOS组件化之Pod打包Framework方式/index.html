<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Cocoapods实现iOS组件化之Pod打包Framework方式"><meta name="keywords" content="组件化,Cocoapods"><meta name="author" content="Nevermore"><meta name="copyright" content="Nevermore"><title>Cocoapods实现iOS组件化之Pod打包Framework方式 | Nevermore's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#准备工作"><span class="toc-number">2.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#本地多Git账号配置"><span class="toc-number">2.1.</span> <span class="toc-text">本地多Git账号配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Git多账号配置"><span class="toc-number">2.1.1.</span> <span class="toc-text">Git多账号配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Git多账号使用"><span class="toc-number">2.1.2.</span> <span class="toc-text">Git多账号使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#开始组件化"><span class="toc-number">3.</span> <span class="toc-text">开始组件化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#组件化步骤"><span class="toc-number">3.1.</span> <span class="toc-text">组件化步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自动配置Pod组件工程的创建"><span class="toc-number">3.2.</span> <span class="toc-text">自动配置Pod组件工程的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cocoapods命令创建"><span class="toc-number">3.2.1.</span> <span class="toc-text">Cocoapods命令创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义创建（采用）"><span class="toc-number">3.2.2.</span> <span class="toc-text">自定义创建（采用）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-pod-lib-create-lt-PodName-gt-命令的实现过程"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">1. pod lib create &lt;PodName&gt;命令的实现过程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-create-rb"><span class="toc-number">3.2.2.1.1.</span> <span class="toc-text">1.1 create.rb</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-pod-template"><span class="toc-number">3.2.2.1.2.</span> <span class="toc-text">1.2 pod-template</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-自定义命令的改进"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">2. 自定义命令的改进</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-Pod-Lib-Templates"><span class="toc-number">3.2.2.2.1.</span> <span class="toc-text">2.1 Pod-Lib-Templates</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-WSPod-rb"><span class="toc-number">3.2.2.2.2.</span> <span class="toc-text">2.2 WSPod.rb</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-终端运行ruby-WSPod-rb-WSTestPod创建Pod组件的过程如下："><span class="toc-number">3.2.2.2.3.</span> <span class="toc-text">2.3 终端运行ruby WSPod.rb WSTestPod创建Pod组件的过程如下：</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#自定义Pod组件工程说明和使用"><span class="toc-number">4.</span> <span class="toc-text">自定义Pod组件工程说明和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Podfile文件"><span class="toc-number">4.1.</span> <span class="toc-text">Podfile文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PodSpec文件"><span class="toc-number">4.2.</span> <span class="toc-text">PodSpec文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PodSpec文件参数说明"><span class="toc-number">4.2.1.</span> <span class="toc-text">PodSpec文件参数说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PodSpec文件使用说明"><span class="toc-number">4.2.2.</span> <span class="toc-text">PodSpec文件使用说明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Pod发布方式说明"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">Pod发布方式说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pod子模块subspec使用说明"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">Pod子模块subspec使用说明</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1、Pod库配置Subspec之后的效果"><span class="toc-number">4.2.2.2.1.</span> <span class="toc-text">1、Pod库配置Subspec之后的效果</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2、Pod库配置Subspec本地目录结构"><span class="toc-number">4.2.2.2.2.</span> <span class="toc-text">2、Pod库配置Subspec本地目录结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3、在podspec文件中配置Subspec"><span class="toc-number">4.2.2.2.3.</span> <span class="toc-text">3、在podspec文件中配置Subspec</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pod组件中Swift和OC混编"><span class="toc-number">4.3.</span> <span class="toc-text">Pod组件中Swift和OC混编</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pod中Swift如何引用OC文件"><span class="toc-number">4.3.1.</span> <span class="toc-text">pod中Swift如何引用OC文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pod中OC如何引用Swift文件"><span class="toc-number">4.3.2.</span> <span class="toc-text">pod中OC如何引用Swift文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pod组件中资源引入方式"><span class="toc-number">4.4.</span> <span class="toc-text">Pod组件中资源引入方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pod组件的解耦"><span class="toc-number">4.5.</span> <span class="toc-text">Pod组件的解耦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#调用方式"><span class="toc-number">4.5.1.</span> <span class="toc-text">调用方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#架构设计思路"><span class="toc-number">4.5.2.</span> <span class="toc-text">架构设计思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件化实现细节"><span class="toc-number">4.5.3.</span> <span class="toc-text">组件化实现细节</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CTMediator组件化使用说明"><span class="toc-number">4.5.4.</span> <span class="toc-text">CTMediator组件化使用说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pod组件打包和发布"><span class="toc-number">4.6.</span> <span class="toc-text">Pod组件打包和发布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#私有组件库Pod-Search"><span class="toc-number">4.7.</span> <span class="toc-text">私有组件库Pod Search</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考链接"><span class="toc-number">5.</span> <span class="toc-text">参考链接</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://i.loli.net/2019/04/02/5ca325e14112a.png"></div><div class="author-info__name text-center">Nevermore</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">5</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">2</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">1</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/04/02/5ca30d6813aa1.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Nevermore's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Cocoapods实现iOS组件化之Pod打包Framework方式</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-03-25</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/iOS/">iOS</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在上两个章节中，已经对<strong><code>自行建立Framework工程</code></strong>作为组建工程的方式进行说明，已经实现了组件化，但开发上有一定局限性。这篇文章在其基础上再一次进行组件化探讨，从保证调试便利、提高实际开发效率和增强扩展性等方面进行考虑，使用 <strong><code>Pod创建和调试，Carthage打包</code></strong> 的方式进行组件化，同时，使用简单的脚本配置工程和发布Pod。</p>
<a id="more"></a>
<p>开始之前先说一下将要进行组件化的工程的开发情况，目前工程已经经历了2年的开发期，采用Swift和OC混编开发，其中Swift和OC基本各占一半，也有将开发代码逐渐全部转化成Swift的想法。组件化最主要的工作是各模块的解耦，使它们成为独立的模块，可以独立使用，也可以和其他模块建立依赖关系，从而构建出一个个新应用。这将面临两个问题：</p>
<ul>
<li>建立便于开发、调试、打包、发布的组件化流程。</li>
<li>如何处理组件之间的耦合性。</li>
</ul>
<p>下面的内容将基于进行组件化的工程、围绕解决上述问题进行说明。</p>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="本地多Git账号配置"><a href="#本地多Git账号配置" class="headerlink" title="本地多Git账号配置"></a>本地多Git账号配置</h2><h3 id="Git多账号配置"><a href="#Git多账号配置" class="headerlink" title="Git多账号配置"></a>Git多账号配置</h3><p>一般在初次安装Git后，会使用如下的命令配置全局用户名和邮箱：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"xxx"</span> // 配置全局用户名，如Github上注册的用户名</span><br><span class="line">$ git config --global user.email <span class="string">"yyy@mail.com"</span> // 配置全局邮箱，如Github上配置的邮箱</span><br></pre></td></tr></table></figure>
<p>这个<code>--global</code>选项，指这里配置的user.name和user.email是相对于全局进行配置的，即不同的Git仓库默认的用户名和邮箱都是这个值。由于需要管理多个账户，所以仅仅使用这个全局值是不够的，需要在每个仓库中单独配置。</p>
<p><strong>1、打开终端，清除全局Git账户配置</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git config --global --<span class="built_in">unset</span> user.name</span><br><span class="line">$ git config --global --<span class="built_in">unset</span> user.email</span><br></pre></td></tr></table></figure>
<p><strong>2、进入 <code>~/.ssh</code> 对每个GitHub账户生成一对密匙。</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// 进入目录，该目录下保存生成的秘钥</span><br><span class="line">$ <span class="built_in">cd</span> ~/.ssh </span><br><span class="line"></span><br><span class="line">//根据账户邮箱生成秘钥</span><br><span class="line">$ ssh-keygen -t rsa -C <span class="string">"*********@163.com"</span></span><br></pre></td></tr></table></figure>
<p>按命令执行完成之后，在<code>~/.ssh</code>下会看到刚刚自己命名创建的两个密匙文件，一个公匙、一个私匙。</p>
<p>同样，对于另一个GitHub上的账户，按照同样的步骤生成一对新的秘钥文件，这个过程中会设置<strong>密匙的密码</strong>。</p>
<p><strong>3、将私匙添加到本地</strong></p>
<p>SSH协议的原理，就是在托管网站上使用公钥，在本地使用私钥，这样本地仓库就可以和远程仓库进行通信。在上一步已经生成了秘钥文件，接下来需要将秘钥文件添加到本地。若不进行这步操作，使用时每次都会提示输入密匙的密码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// 将GitHub私钥添加到本地</span><br><span class="line">$ ssh-add ~/.ssh/&lt;私匙文件1&gt; </span><br><span class="line">$ ssh-add ~/.ssh/&lt;私匙文件2&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用<code>ssh-add -l</code>命令查看添加过的私匙文件</p>
</blockquote>
<p><strong>4、对本地秘钥进行配置</strong></p>
<p>由于添加了多个密钥文件，所以需要对这多个密钥进行管理。在.ssh目录下新建一个 <em>config</em> 文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/.ssh </span><br><span class="line">$ touch config</span><br></pre></td></tr></table></figure>
<p>文件内容如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#github ***************@163.com</span></span><br><span class="line">    host bigboss 				</span><br><span class="line">    Hostname github.com	</span><br><span class="line">    User BigBoss666</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment">#github bakwisdomschool@163.com</span></span><br><span class="line">    host wisdomschool  		</span><br><span class="line">    Hostname github.com 	</span><br><span class="line">    User BakWisdomSchool 	</span><br><span class="line">    IdentityFile ~/.ssh/ws_id_rsa</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>host</strong> 是托管服务器的别名，随便取，很重要，后面会用到。</p>
<p><strong>Hostname</strong> 是托管服务器名，我们托管在GitHub下，服务器名是 <code>github.com</code> 。</p>
<p><strong>User</strong> 是GitHub用户名。</p>
<p><strong>IdentityFile</strong> 是私匙的路径。</p>
</blockquote>
<p><strong>5、公钥添加到托管网站</strong></p>
<p>以GitHub为例，进入<code>~/.ssh</code>目录，复制公匙文件内容。</p>
<p>登录GitHub，点击右上角头像选择settings，在打开的页面中选择<strong>SSH and GPG keys</strong>，新建一个<strong>SSH key</strong>，将公匙内容粘贴在key中。</p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-03-25_1_34_23.png" alt="2019-03-25_1_34_23"></p>
<p>至此，托管网站的公钥添加完成。总结来说，就是针对每个托管网站分别生成一对密钥，然后分别添加到本地和托管网站。</p>
<p>现在，可以测试一下配置是否成功，测试命令使用别名。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh -T git@&lt;github服务器别名&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Git多账号使用"><a href="#Git多账号使用" class="headerlink" title="Git多账号使用"></a>Git多账号使用</h3><p>为了和本地密匙文件配对，在拉取和关联远程仓库时使用SSH Url，需要将其中的 <strong>Git服务器名</strong> 换成 <em>config</em> 文件中的 <strong>Git服务器别名</strong>。如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// 拉取远程仓库到本地</span><br><span class="line">$ git <span class="built_in">clone</span> git@&lt;github服务器别名&gt;:******/***.git </span><br><span class="line"></span><br><span class="line">// 关联远程仓库和本地</span><br><span class="line">$ git remote add origin git@&lt;github服务器别名&gt;:******/***.git</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意：</strong><br>    使用 <strong>Https Url</strong> 关联仓库时可能每次上传更新都需要输入密匙的密码，采用 <strong>SSH Url</strong> 和仓库关联。</p>
</blockquote>
<p>按上述步骤完成配置以后，以后账号会自动切换。</p>
<h1 id="开始组件化"><a href="#开始组件化" class="headerlink" title="开始组件化"></a>开始组件化</h1><h2 id="组件化步骤"><a href="#组件化步骤" class="headerlink" title="组件化步骤"></a>组件化步骤</h2><p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/Cocoapods私有组件代码托管原理(Git" alt="Cocoapods私有组件代码托管原理(Git)">.png)</p>
<p>参照上图，梳理一下使用Cocoapods开发私有组件库的步骤：</p>
<ul>
<li><p>首先，我们需要一个远程托管服务器平台，git或者svn都可以。本篇博文使用git托管组件库，下一篇博文会介绍使用svn托管私有组件库。</p>
</li>
<li><p>明确完成一个Pod组件的开发需要两个远程仓库。为了使组件库私有，需要采用创建私有仓库：一个<strong>远程私有索引库</strong>和一个<strong>远程私有源码库</strong>。<strong>远程私有索引库</strong>中存放组件各个历史版本的<em>Podspec</em>文件，作为引用该组件的索引；<strong>远程私有源码库</strong>存放组件源代码、资源文件等。第2步和第4步分别在服务器创建这两个远程仓库。</p>
</li>
<li><p>第3步将<strong>远程私有索引库</strong>clone到本地路径<code>~/.cocoapods/repos</code>下面，当在<em>podfile</em>文件中引用了Pod库之后，使用<code>pod install</code>装载某个Pod组件库时，首先会在其中的podspec本地索引文件中查找到相应库文件的远程源码地址，通过这个地址将Pod组件库clone到本地，这样我们就可以使用远程Pod组件库了。正因为需要将远程索引库添加到本地，没有权限clone<strong>远程私有索引库</strong>的话，也就无法通过上面的使用方式来使用索引库中的Pod组件库了。</p>
</li>
<li><p>第5步是创建本地Pod组件库。为了开发组件库，在本地创建一个开发、调试工程。可以通过Cocoapods提供的命令<code>pod lib create &lt;PodName&gt;</code>自动创建，也可以根据自身的需求自定义创建。</p>
</li>
<li><p>第6步，将本地组件工程和<strong>远程私有源码库</strong>关联起来，在开发、调试过程中可自行同步本地工程和<strong>远程私有源码库</strong>。当发布组件库的新版本时，需要通过第6.4步，将当前推送到<strong>远程私有源码库</strong>的版本打上tag，并将tag也推送到远程库。注意tag号要和本地组件工程中的<em>podspec</em>文件中的Pod库版本一致。</p>
</li>
<li><p>以上准备工作做好之后，通过第7步中的命令即可发布Pod库的新版本。这里解释一下这个过程，当通过命令行发布Pod库时：首先会对发布的内容进行验证；然后拉取<strong>远程私有索引库</strong>来更新本地的索引库；再将本地组件工程中维护的<em>podspec</em>文件添加到<strong>本地私有索引库</strong>中的对应版本路径下；最后，推送<strong>本地私有索引库</strong>中的新内容到<strong>远程私有索引库</strong>中。这样当小伙伴要使用你的库时，只需要使用<code>pod update</code>更新本地Pod库并装载最新的版本即可。</p>
</li>
</ul>
<p>使用git托管进行Cocoapods私有组件库开发的大致流程就讲述完了，下面将对具体使用进行说明。</p>
<h2 id="自动配置Pod组件工程的创建"><a href="#自动配置Pod组件工程的创建" class="headerlink" title="自动配置Pod组件工程的创建"></a>自动配置Pod组件工程的创建</h2><h3 id="Cocoapods命令创建"><a href="#Cocoapods命令创建" class="headerlink" title="Cocoapods命令创建"></a>Cocoapods命令创建</h3><p>Cocoapods提供了创建Pod静态库工程的命令：<code>pod lib create &lt;PodName&gt;</code>，经过如下几项参数的选择后可以为我们创建一个便于开发和调试Pod组件的Xcode工程。<br><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-24_9_25_16.png" alt="2019-04-24_9_25_16"></p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-24_9_32_04.png" alt="2019-04-24_9_32_04"></p>
<p>在<strong>测试工程</strong>的Podfile中本地引用<strong>Pod库工程</strong>，可在修改<strong>Pod库工程</strong>源码的同时，在测试工程中对Pod组件的功能进行调试。对每一个Pod组件模块开发、测试成功后即可提供使用。</p>
<h3 id="自定义创建（采用）"><a href="#自定义创建（采用）" class="headerlink" title="自定义创建（采用）"></a>自定义创建（采用）</h3><p>虽然通过<code>pod lib create &lt;PodName&gt;</code>命令可以方便地为我们创建组件库工程，但若要使创建的组件库工程有更大的自由度、可以添加更多动态的配置的话就需要对<code>pod lib create &lt;PodName&gt;</code>命令的实现过程进行研究后再实现自定义创建组件库工程。</p>
<h4 id="1-pod-lib-create-lt-PodName-gt-命令的实现过程"><a href="#1-pod-lib-create-lt-PodName-gt-命令的实现过程" class="headerlink" title="1. pod lib create &lt;PodName&gt;命令的实现过程"></a>1. <code>pod lib create &lt;PodName&gt;</code>命令的实现过程</h4><p>Cocoapods这个命令实现涉及两个相关工程：<a href="https://github.com/CocoaPods/CocoaPods" target="_blank" rel="noopener">CocoaPods</a>、<a href="https://github.com/CocoaPods/pod-template" target="_blank" rel="noopener">pod-template</a>。</p>
<h5 id="1-1-create-rb"><a href="#1-1-create-rb" class="headerlink" title="1.1 create.rb"></a>1.1 create.rb</h5><p>这条命令就是执行<strong>CocoaPods</strong>工程下的create.rb这个Ruby文件，文件的具体路径是: <em>CocoaPods/lib/cocoapods/command/lib/create.rb</em>，它会执行下面命令。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">clone_template	<span class="comment"># clone pod-template 这个模板仓库到本地</span></span><br><span class="line"></span><br><span class="line">configure_template	<span class="comment"># 调用 pod-template/configure 文件</span></span><br><span class="line"></span><br><span class="line">print_info	<span class="comment"># 打印结果</span></span><br></pre></td></tr></table></figure>
<h5 id="1-2-pod-template"><a href="#1-2-pod-template" class="headerlink" title="1.2 pod-template"></a>1.2 pod-template</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">pod-template-master</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">├── CODE_OF_CONDUCT.md</span><br><span class="line">├── LICENSE</span><br><span class="line">├── NAME-osx.podspec</span><br><span class="line">├── NAME.podspec</span><br><span class="line">├── POD_LICENSE</span><br><span class="line">├── POD_README.md</span><br><span class="line">├── Pod</span><br><span class="line">│   ├── Assets</span><br><span class="line">│   └── Classes</span><br><span class="line">├── README.md</span><br><span class="line">├── configure</span><br><span class="line">├── setup</span><br><span class="line">│   ├── ConfigureMacOSSwift.rb</span><br><span class="line">│   ├── ConfigureSwift.rb</span><br><span class="line">│   ├── ConfigureiOS.rb</span><br><span class="line">│   ├── MessageBank.rb</span><br><span class="line">│   ├── ProjectManipulator.rb</span><br><span class="line">│   ├── TemplateConfigurator.rb</span><br><span class="line">│   └── test_examples</span><br><span class="line">│       ├── kiwi.m</span><br><span class="line">│       ├── quick.swift</span><br><span class="line">│       ├── specta.m</span><br><span class="line">│       ├── xctest.m</span><br><span class="line">│       └── xctest.swift</span><br><span class="line">└── templates</span><br><span class="line">    ├── ios</span><br><span class="line">    │   └── Example</span><br><span class="line">    ├── macos-swift</span><br><span class="line">    │   └── Example</span><br><span class="line">    └── swift</span><br><span class="line">        └── Example</span><br></pre></td></tr></table></figure>
<p><em>configure</em>文件中指定运行<em>TemplateConfigurator.rb</em>，在<em>TemplateConfigurator.rb</em>中的 run 方法定义了配置工程的所有步骤。简单而言就是使用setup路径下的其他Ruby配置文件对templates路劲下的模板工程进行配置，对其他配置文件进行编辑修改，然后删除不需要的文件，最后生成一个新的组件工程。</p>
<h4 id="2-自定义命令的改进"><a href="#2-自定义命令的改进" class="headerlink" title="2. 自定义命令的改进"></a>2. 自定义命令的改进</h4><p>在理解了Cocoapods创建组件的思路后，我们可以自定义配置文件创建更适合自身需求的Pod组件工程生成方式。</p>
<h5 id="2-1-Pod-Lib-Templates"><a href="#2-1-Pod-Lib-Templates" class="headerlink" title="2.1 Pod-Lib-Templates"></a>2.1 Pod-Lib-Templates</h5><p>根据自身的需求，创建远程仓库<strong>Pod-Lib-Templates</strong>作为自己的模板仓库。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Pod-Lib-Templates</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">├── LICENSE</span><br><span class="line">├── NAME.podspec</span><br><span class="line">├── POD_LICENSE</span><br><span class="line">├── POD_README.md</span><br><span class="line">├── Pod</span><br><span class="line">│   ├── Classes</span><br><span class="line">│   ├── Frameworks</span><br><span class="line">│   └── Resources</span><br><span class="line">├── README.md</span><br><span class="line">├── Setup</span><br><span class="line">│   ├── ConfigureSwift.rb</span><br><span class="line">│   ├── MessageBank.rb</span><br><span class="line">│   ├── ProjectManipulator.rb</span><br><span class="line">│   └── TemplateConfigurator.rb</span><br><span class="line">├── Templates</span><br><span class="line">│   └── Swift</span><br><span class="line">├── auto.py</span><br><span class="line">├── configure</span><br><span class="line">└── gitignore</span><br></pre></td></tr></table></figure>
<ul>
<li>配置了一个Swift工程作为组件工程。</li>
<li>Setup路径下自定义了4的Ruby文件，基于<em>TemplateConfigurator.rb</em>文件对<strong>Pod-Lib-Templates</strong>进行配置，生成最终的组件工程。</li>
<li>自定义了组件工程需要的文件的模板文件：<em>LICENSE</em>、<em>NAME.podspec</em>、<em>POD_LICENSE</em>、<em>POD_README.md</em>、<em>README.md</em>、<em>gitignore</em>、<em>.gitignore</em>。通过Setup中的Ruby配置文件的配置之后会生成组件所需的文件。</li>
<li>自定义了<code>Pod/Classes</code>、<code>Pod/Frameworks</code>、<code>Pod/Resources</code>路径，分别作为组件源码、组件库文件、组件资源文件存放的路径。</li>
<li>自定义<em>auto.py</em>文件，用于自动发布Pod组件库。</li>
</ul>
<h5 id="2-2-WSPod-rb"><a href="#2-2-WSPod-rb" class="headerlink" title="2.2 WSPod.rb"></a>2.2 WSPod.rb</h5><p>参照CocoaPods的<em>create.rb</em>，自定义<em>WSPod.rb</em>文件作为创建我们自定义Pod组件工程的工具，使用Ruby工具运行它会执行下面的命令：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">clone_template	<span class="comment"># clone Pod-Lib-Templates 这个模板仓库到本地</span></span><br><span class="line"></span><br><span class="line">configure_template	<span class="comment"># 调用 Pod-Lib-Templates/configure 文件</span></span><br><span class="line"></span><br><span class="line">print_info	<span class="comment"># 打印结果</span></span><br></pre></td></tr></table></figure>
<p>这里<code>clone_template</code>是clone我们自定义的<strong>Pod-Lib-Templates</strong>，再使用我们自定义的配置文件和自定义的各种模板文件配置出我们需要的Pod组件工程。</p>
<h5 id="2-3-终端运行ruby-WSPod-rb-WSTestPod创建Pod组件的过程如下："><a href="#2-3-终端运行ruby-WSPod-rb-WSTestPod创建Pod组件的过程如下：" class="headerlink" title="2.3 终端运行ruby WSPod.rb WSTestPod创建Pod组件的过程如下："></a>2.3 终端运行<code>ruby WSPod.rb WSTestPod</code>创建Pod组件的过程如下：</h5><p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-27_10_57_12.png" alt="2019-04-27_10_57_12"></p>
<p>最终WSTestPod的文件目录如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">WSTestPod</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">├── Example</span><br><span class="line">│   ├── Podfile</span><br><span class="line">│   ├── Podfile.lock</span><br><span class="line">│   ├── Pods</span><br><span class="line">│   ├── WSTestPod</span><br><span class="line">│   ├── WSTestPod.xcodeproj</span><br><span class="line">│   └── WSTestPod.xcworkspace</span><br><span class="line">├── LICENSE</span><br><span class="line">├── README.md</span><br><span class="line">├── WSTestPod</span><br><span class="line">│   ├── Classes</span><br><span class="line">│   ├── Frameworks</span><br><span class="line">│   └── Resources</span><br><span class="line">├── WSTestPod.podspec</span><br><span class="line">├── _Pods.xcodeproj -&gt; Example/Pods/Pods.xcodeproj</span><br><span class="line">├── auto.py</span><br><span class="line">└── gitignore</span><br></pre></td></tr></table></figure>
<ul>
<li><code>WSTestPod</code>路径下存放<strong>WSTestPod</strong>这个Pod组件的相关文件。</li>
<li><code>Example</code>路径下是一个Signle App Project，用于测试和打包Pod组件。</li>
<li><em>LICENSE</em> 是自定义的许可文件。</li>
<li><em>README.md</em> 是自定义的Pod组件说明文件。</li>
<li><em>WSTestPod.podspec</em> 是自定义的Pod组件podspec配置文件。</li>
<li><em>auto.py</em> 是自定义的Pod组件自动发布脚本文件。</li>
<li><em>gitignore</em> 是自定义的git推送忽略文件。</li>
<li><em>.gitignore</em> 是自定义的git推送忽略文件。</li>
</ul>
<p>到此，我们已经将自定义Pod组件工程的一系列准备工作做好，可以开始开发和调试Pod组件，并发布到远程库。</p>
<p>这只是刚刚搭建好整体框架思路，详细使用说明继续讲解。</p>
<h1 id="自定义Pod组件工程说明和使用"><a href="#自定义Pod组件工程说明和使用" class="headerlink" title="自定义Pod组件工程说明和使用"></a>自定义Pod组件工程说明和使用</h1><p>以下都基于上文已经搭建好的自定义组件工程思路进行使用说明。</p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-28_12_36_29.png" alt="2019-04-28_12_36_29"></p>
<h2 id="Podfile文件"><a href="#Podfile文件" class="headerlink" title="Podfile文件"></a>Podfile文件</h2><p>Podfile文件是iOS工程引用Pod库的配置文件，在这里不做说明，使用自行Google/Baidu。</p>
<p>这里参照下面自定义的Podfile模板文件说明两点：1、引用私有库需要在Podfile文件中加上<strong>远程私有索引库地址</strong>；2、开发、调试时使用本地引用Pod库，发布成功后可去掉本地引用，<code>pod install</code>或<code>pod update</code>使用远程Pod库。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">platform :ios, &apos;9.0&apos;</span><br><span class="line"></span><br><span class="line">source &apos;https://github.com/CocoaPods/Specs.git&apos;</span><br><span class="line">source &apos;https://github.com/*********.git&apos;  # 远程私有索引库地址</span><br><span class="line"></span><br><span class="line">use_frameworks!</span><br><span class="line"></span><br><span class="line">target &apos;$&#123;POD_NAME&#125;_Example&apos; do</span><br><span class="line">  pod &apos;$&#123;POD_NAME&#125;&apos;, :path =&gt; &apos;../&apos;	# 本地引用Pod库</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="PodSpec文件"><a href="#PodSpec文件" class="headerlink" title="PodSpec文件"></a>PodSpec文件</h2><p>PodSpec文件是Pod库的配置文件，参照<a href="https://guides.cocoapods.org/syntax/podspec.html" target="_blank" rel="noopener">Podspec Syntax Reference</a>可以对Pod组件库进行各种配置。简单来说，Cocoapods可以使用podspec文件中的配置，将指定路径下的内容打包成库文件，并发布到远程代码仓库，使其成为远程Pod库。</p>
<h3 id="PodSpec文件参数说明"><a href="#PodSpec文件参数说明" class="headerlink" title="PodSpec文件参数说明"></a>PodSpec文件参数说明</h3><p>使用<em>WSPod.rb</em>创建组件工程时，<em>TemplateConfigurator.rb</em>配置文件会将自定义的podspec模板文件<em>NAME.podspec</em>修改成对应组件的podspec文件。下面是<em>NAME.podspec</em>，自定义了一些参数配置，实际开发中要灵活运用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  Be sure to run `pod spec lint $&#123;POD_NAME&#125;.podspec' to ensure this is a</span></span><br><span class="line"><span class="comment">#  valid spec and to remove all comments including this before submitting the spec.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  To learn more about Podspec attributes see https://docs.cocoapods.org/specification.html</span></span><br><span class="line"><span class="comment">#  To see working Podspecs in the CocoaPods repo see https://github.com/CocoaPods/Specs/</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">Pod::Spec.new <span class="keyword">do</span> |spec|</span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  基本参数  =================================================================================== #</span></span><br><span class="line">  spec.name         = <span class="string">"<span class="variable">$&#123;POD_NAME&#125;</span>"</span></span><br><span class="line">  spec.version      = <span class="string">"1.0.-1"</span></span><br><span class="line">  spec.summary      = <span class="string">"<span class="variable">$&#123;POD_NAME&#125;</span>"</span></span><br><span class="line">  spec.description      = &lt;&lt;-DESC</span><br><span class="line">  this is <span class="variable">$&#123;POD_NAME&#125;</span></span><br><span class="line">  DESC</span><br><span class="line"></span><br><span class="line">  spec.homepage     = <span class="string">"https://github.com/BakWisdomSchool"</span></span><br><span class="line"></span><br><span class="line">  spec.license      = &#123; :<span class="built_in">type</span> =&gt; <span class="string">"MIT"</span>, :file =&gt; <span class="string">"LICENSE"</span> &#125;</span><br><span class="line"></span><br><span class="line">  spec.author       = &#123; <span class="string">"BakWisdomSchool"</span> =&gt; <span class="string">"bakwisdomschool@163.com"</span> &#125;</span><br><span class="line"></span><br><span class="line">  spec.platform     = :ios, <span class="string">"9.0"</span></span><br><span class="line"></span><br><span class="line">  spec.source       = &#123; :git =&gt; <span class="string">"https://github.com/BakWisdomSchool/<span class="variable">$&#123;POD_NAME&#125;</span>.git"</span>, :tag =&gt; spec.version.to_s &#125;</span><br><span class="line"></span><br><span class="line">  spec.requires_arc = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  spec.swift_version = <span class="string">"5.0"</span></span><br><span class="line"></span><br><span class="line">  spec.preserve_paths = <span class="string">"Example/Carthage/Build/iOS/**/*.&#123;framework&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  发布源文件包Pod的方式  ================================================================================ #</span></span><br><span class="line">  spec.source_files  = <span class="string">"<span class="variable">$&#123;POD_NAME&#125;</span>/Classes/**/*.&#123;h,m,swift&#125;"</span></span><br><span class="line"></span><br><span class="line">  spec.resource_bundles = &#123;</span><br><span class="line">    <span class="string">'$&#123;POD_NAME&#125;Res'</span> =&gt; [<span class="string">'$&#123;POD_NAME&#125;/Resources/**/*.&#123;xcassets, json&#125;'</span>, <span class="string">'$&#123;POD_NAME&#125;/Classes/**/*.&#123;xib&#125;'</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  spec.vendored_frameworks = <span class="string">"<span class="variable">$&#123;POD_NAME&#125;</span>/Frameworks/**/*.&#123;framework&#125;"</span></span><br><span class="line"></span><br><span class="line">  spec.vendored_library = <span class="string">"<span class="variable">$&#123;POD_NAME&#125;</span>/Frameworks/**/*.&#123;a&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  发布二进制包Pod的方式  ================================================================================ #</span></span><br><span class="line"><span class="comment"># spec.vendored_frameworks = "Example/Carthage/Build/iOS/$&#123;POD_NAME&#125;.framework"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  Pod依赖的第三Pod方库  ================================================================================ #</span></span><br><span class="line">  <span class="comment"># pod依赖的第三方库</span></span><br><span class="line"><span class="comment">#  spec.dependency "JSONKit", "~&gt; 1.4"</span></span><br><span class="line"><span class="comment">#  spec.dependency "CTMediator"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  Pod依赖的系统库  ================================================================================= #</span></span><br><span class="line"><span class="comment">#  # pod依赖的苹果的framework，比如UIKit，SystemConfiguration等等</span></span><br><span class="line"><span class="comment">#  spec.framework  = "SomeFramework"</span></span><br><span class="line"><span class="comment">#  spec.frameworks = "SomeFramework", "AnotherFramework"</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  # pod依赖的苹果官方的库，也就是类似libstdc++.a ,libsqlite.a 等等的a文件</span></span><br><span class="line"><span class="comment">#  spec.library   = "iconv"</span></span><br><span class="line"><span class="comment">#  spec.libraries = "iconv", "xml2"</span></span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>spec.name</strong>：Pod组件的名字。</li>
<li><strong>spec.version</strong>：Pod组件的版本，一定要和发布Pod时git tag的版本一致，否则会发布失败。</li>
<li><strong>spec.source</strong>：Pod组件的地址，这里写组件的<strong>远程私有源码库地址</strong>。</li>
<li><strong>spec.swift_version</strong>：podspec文件如果需要指定swift版本，版本不正确swift编译可能报错。</li>
<li><strong>spec.source_files</strong>：指定Pod库源文件路径，是相对于<strong>spec.source</strong>的路径，路径下的内容会显示在主工程的 <code>Pods - Development Pods - &lt;组件Pod库&gt;</code> 路径下。</li>
<li><strong>spec.vendored_frameworks</strong>：指定Pod库依赖的本地framework路径，是相对于<strong>spec.source</strong>的路径，路径下的内容会显示在主工程的 <code>Pods - Development Pods - &lt;组件Pod库&gt; - Frameworks</code> 路径下。</li>
<li><strong>spec.vendored_library</strong>：指定Pod库依赖的本地.a静态库路径，是相对于<strong>spec.source</strong>的路径，路径下的内容会显示在主工程的 <code>Pods - Development Pods - &lt;组件Pod库&gt; - Frameworks</code> 路径下。</li>
<li><strong>spec.resource_bundles</strong>：指定Pod库包含的资源文件路径，是相对于<strong>spec.source</strong>的路径，路径下的内容会显示在主工程的 <code>Pods - Development Pods - &lt;组件Pod库&gt; - Resources</code> 路径下。</li>
<li><strong>spec.resources</strong>：也是用来配置Pod中的资源文件的，其配置的路径下的内容会显示在主工程的 <code>Pods - Development Pods - &lt;组件Pod库&gt; - Resources</code> 路径下。但这种配置方式和使用 <strong>resource_bundles</strong> 进行配置有很大区别，官方已经明确不推荐使用，后面会进行说明。</li>
<li><strong>spec.dependency</strong>：指定此Pod库依赖的其他远程Pod库，形成关联关系，安装当前Pod库时Cocoapods会自动安装其依赖的其他远程Pod库。</li>
<li><strong>spec.subspec：</strong> 定义Pod库的子模块，对封装工具类Pod等包含很多不同功能的Pod库有好处，使用时只需要引用Pod中需要的部分。</li>
</ul>
<h3 id="PodSpec文件使用说明"><a href="#PodSpec文件使用说明" class="headerlink" title="PodSpec文件使用说明"></a>PodSpec文件使用说明</h3><p>开发和调试过程使用本地引用Pod库方式，在编辑或修改podspec文件后在Example路径下执行<code>pod install</code>会根据podspec文件的修改在Xcode组件工程中更新Pod组件。</p>
<h4 id="Pod发布方式说明"><a href="#Pod发布方式说明" class="headerlink" title="Pod发布方式说明"></a>Pod发布方式说明</h4><p>PodSpec文件参数 <strong>source_files</strong>、<strong>vendored_frameworks</strong>、<strong>vendored_library</strong>、<strong>resource_bundles</strong> 指定路径下的文件内容会被打包成最终的库文件。</p>
<p>PodSpec文件中 <strong>发布源文件包的方式</strong> 和 <strong>发布二进制包的方式</strong> 下的两种配置参数控制了发布出去的Pod库的内容：</p>
<ul>
<li>以<strong>源文件包</strong>的方式发布的话，<strong>spec.source</strong>中的源文件是可见的。</li>
<li>为了隐藏Pod组件的源文件，首先在开发和调试的时候使用<strong>发布源文件包的方式</strong>配置Pod组件工程中的Pod库，开发完成后打包出Pod库文件，发布时注释podspec文件中的<strong>发布源文件包的方式</strong>，放开<strong>发布二进制包的方式</strong>下的注释，将spec.vendored_framework配置的路径设置为打包出的Pod库文件的路径，此时再使用podspec配置文件发布Pod库即为只发布一个包含Pod完整功能的库文件，隐藏了Pod库的源码。</li>
</ul>
<p>发布组件的一系列操作已加入到自动发布脚本文件<em>auto.py</em>中。</p>
<h4 id="Pod子模块subspec使用说明"><a href="#Pod子模块subspec使用说明" class="headerlink" title="Pod子模块subspec使用说明"></a>Pod子模块subspec使用说明</h4><h5 id="1、Pod库配置Subspec之后的效果"><a href="#1、Pod库配置Subspec之后的效果" class="headerlink" title="1、Pod库配置Subspec之后的效果"></a>1、Pod库配置Subspec之后的效果</h5><p>Pod私有库<strong>CommonKits</strong>配置subspec实现子组件完成后的效果如下图所示：</p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-28_16_06_35.png" alt="2019-04-28_16_06_35"></p>
<p>从图中可以看出，Pod库<strong>CommonKits</strong>包含<strong>CommonKits_BaseView</strong>、<strong>CommonKits_CustomProtocol</strong>、<strong>CommonKits_CustomView</strong>、<strong>CommonKits_Extension</strong>、<strong>CommonKits_Tools</strong>这5个子模块。<strong>CommonKits_Tools</strong>又包含<strong>CommonKits_Tools_CoreAnimator</strong>、<strong>CommonKits_Tools_MoreTools</strong>、<strong>CommonKits_Tools_SwiftyDB</strong>、<strong>CommonKits_Tools_UIControls</strong>这4个子模块。使用时可以在Podfile文件中指定只加载部分子模块的内容，减少不必要的内容引用。下面分析如何实现subspec功能。</p>
<h5 id="2、Pod库配置Subspec本地目录结构"><a href="#2、Pod库配置Subspec本地目录结构" class="headerlink" title="2、Pod库配置Subspec本地目录结构"></a>2、Pod库配置Subspec本地目录结构</h5><p>CommonKits的工程本地目录部分内容如下，在Classes路径下按上面提到的内容包含关系将源文件放入指定的路径中。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CommonKits</span><br><span class="line"></span><br><span class="line">.</span><br><span class="line">├── CommonKits</span><br><span class="line">│   ├── Classes</span><br><span class="line">│   │   ├── BaseView</span><br><span class="line">│   │   ├── CustomProtocol</span><br><span class="line">│   │   ├── CustomView</span><br><span class="line">│   │   ├── Extension</span><br><span class="line">│   │   ├── Tools</span><br><span class="line">│	│	│	├── CoreAnimator</span><br><span class="line">│   │   │   ├── MoreTools</span><br><span class="line">│   │   │   ├── SwiftyDB</span><br><span class="line">│   │   │   └── UIControls</span><br><span class="line">│   │   └── Utilities</span><br><span class="line">│   └── Resources</span><br><span class="line">├── CommonKits.podspec</span><br><span class="line">├── CommonKits_BaseView.podspec</span><br><span class="line">├── CommonKits_CustomProtocol.podspec</span><br><span class="line">├── CommonKits_CustomView.podspec</span><br><span class="line">├── CommonKits_Extension.podspec</span><br><span class="line">├── CommonKits_Tools.podspec</span><br><span class="line">├── CommonKits_Tools_CoreAnimator.podspec</span><br><span class="line">├── CommonKits_Tools_MoreTools.podspec</span><br><span class="line">├── CommonKits_Tools_SwiftyDB.podspec</span><br><span class="line">├── CommonKits_Tools_UIControls.podspec</span><br><span class="line">├── CommonKits_Utilities.podspec</span><br><span class="line">├── Example</span><br></pre></td></tr></table></figure>
<p>每一个Pod库都需要一个podspec文件进行配置才能导出对应的库文件，在podspec中配置subspec时如果是配置子模块的<strong>source_files</strong>地址同样会有暴露源文件的问题，因此，我们在子模块中同样也使用<strong>vendored_frameworks</strong>参数配置打包好的子模块的库文件引用来避免这个问题。</p>
<p>那么，如何打包这么多的子模块呢！使用Cocoapods提供的打包工具<strong>cocoapods-packager</strong>可以在Pod组件的podspec文件中配置好subspec之后使用命令打出指定子模块的库文件，但是这个工具已经长期不再维护，且对Swift的支持不好，多次尝试我们的工程后无法正常打出库文件，经过测试后决定采用更轻便快捷的打包工具Carthage对我们的Pod组件和子模块进行打包。具体使用方法见后面Carthage的使用说明。</p>
<p>使用Carthage打包则需要为每个子组件也创建一个podspec文件，用来配置这个Pod子组件库，所以在和<em>CommonKits.podspec</em>同级的路径下为每一个Pod子组件创建对应的podspec文件，里面只需要简单配置子组件的数据引用路径和依赖库即可。例如<em>CommonKits_Tools_SwiftyDB.podspec</em>的关键内容如下：</p>
<figure class="highlight podspec"><table><tr><td class="code"><pre><span class="line">CommonKits_Tools_SwiftyDB.podspec</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  发布源文件包Pod的方式  ================================================================================ #</span></span><br><span class="line">  spec.source_files  = <span class="string">'CommonKits/Classes/Tools/SwiftyDB/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  Pod依赖的第三Pod方库  ================================================================================ #</span></span><br><span class="line">  <span class="comment"># pod依赖的第三方库</span></span><br><span class="line">  spec.dependency <span class="string">"FMDB"</span></span><br></pre></td></tr></table></figure>
<h5 id="3、在podspec文件中配置Subspec"><a href="#3、在podspec文件中配置Subspec" class="headerlink" title="3、在podspec文件中配置Subspec"></a>3、在podspec文件中配置Subspec</h5><p>最后再来看一下<em>CommonKits.podspec</em>文件中对subspec的配置。</p>
<figure class="highlight podspec"><table><tr><td class="code"><pre><span class="line"><span class="comment"># CommonKits.podspec</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  发布源文件包Pod的方式  ================================================================================ #</span></span><br><span class="line">  spec.source_files  = <span class="string">'CommonKits/Classes/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line"></span><br><span class="line">  spec.resource_bundles = &#123;</span><br><span class="line">    <span class="string">'CommonKitsRes'</span> =&gt; [<span class="string">'CommonKits/Resources/**/*.&#123;xcassets, json&#125;'</span>, <span class="string">'CommonKits/Classes/**/*.&#123;xib&#125;'</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  spec.subspec <span class="string">'CommonKits_Utilities'</span> <span class="keyword">do</span> <span class="params">|uti|</span></span><br><span class="line">    uti.source_files = <span class="string">'CommonKits/Classes/Utilities/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  spec.subspec <span class="string">'CommonKits_Extension'</span> <span class="keyword">do</span> <span class="params">|extension|</span></span><br><span class="line">    extension.source_files = <span class="string">'CommonKits/Classes/Extension/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  spec.subspec <span class="string">'CommonKits_CustomView'</span> <span class="keyword">do</span> <span class="params">|customview|</span></span><br><span class="line">    customview.source_files = <span class="string">'CommonKits/Classes/CustomView/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  spec.subspec <span class="string">'CommonKits_BaseView'</span> <span class="keyword">do</span> <span class="params">|baseview|</span></span><br><span class="line">    baseview.source_files = <span class="string">'CommonKits/Classes/BaseView/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  spec.subspec <span class="string">'CommonKits_CustomProtocol'</span> <span class="keyword">do</span> <span class="params">|customprotocol|</span></span><br><span class="line">    customprotocol.source_files = <span class="string">'CommonKits/Classes/CustomProtocol/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  spec.subspec <span class="string">'CommonKits_Tools'</span> <span class="keyword">do</span> <span class="params">|tool|</span></span><br><span class="line">    tool.source_files = <span class="string">'CommonKits/Classes/Tools/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line"></span><br><span class="line">    tool.subspec <span class="string">'CommonKits_Tools_SwiftyDB'</span> <span class="keyword">do</span> <span class="params">|db|</span></span><br><span class="line">      db.source_files = <span class="string">'CommonKits/Classes/Tools/SwiftyDB/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line"></span><br><span class="line">      db.dependency <span class="string">'FMDB'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    tool.subspec <span class="string">'CommonKits_Tools_UIControls'</span> <span class="keyword">do</span> <span class="params">|uicontrols|</span></span><br><span class="line">      uicontrols.source_files = <span class="string">'CommonKits/Classes/Tools/UIControls/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    tool.subspec <span class="string">'CommonKits_Tools_CoreAnimator'</span> <span class="keyword">do</span> <span class="params">|db|</span></span><br><span class="line">      db.source_files = <span class="string">'CommonKits/Classes/Tools/CoreAnimator/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    tool.subspec <span class="string">'CommonKits_Tools_MoreTools'</span> <span class="keyword">do</span> <span class="params">|db|</span></span><br><span class="line">      db.source_files = <span class="string">'CommonKits/Classes/Tools/MoreTools/**/*.&#123;h,m,swift&#125;'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ======  发布二进制包Pod的方式  ================================================================================ #</span></span><br><span class="line"><span class="comment"># spec.vendored_frameworks = "Example/Carthage/Build/iOS/CommonKits.framework"</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># spec.subspec 'CommonKits_Utilities' do |uti|</span></span><br><span class="line"><span class="comment">#   uti.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Utilities.framework'</span></span><br><span class="line"><span class="comment"># end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># spec.subspec 'CommonKits_Extension' do |extension|</span></span><br><span class="line"><span class="comment">#   extension.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Extension.framework'</span></span><br><span class="line"><span class="comment"># end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># spec.subspec 'CommonKits_CustomView' do |customview|</span></span><br><span class="line"><span class="comment">#   customview.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_CustomView.framework'</span></span><br><span class="line"><span class="comment"># end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># spec.subspec 'CommonKits_BaseView' do |baseview|</span></span><br><span class="line"><span class="comment">#   baseview.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_BaseView.framework'</span></span><br><span class="line"><span class="comment"># end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># spec.subspec 'CommonKits_CustomProtocol' do |customprotocol|</span></span><br><span class="line"><span class="comment">#   customprotocol.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_CustomProtocol.framework'</span></span><br><span class="line"><span class="comment"># end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># spec.subspec 'CommonKits_Tools' do |tool|</span></span><br><span class="line"><span class="comment">#   tool.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Tools.framework'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   tool.subspec 'CommonKits_Tools_SwiftyDB' do |db|</span></span><br><span class="line"><span class="comment">#     db.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Tools_SwiftyDB.framework'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#     db.dependency 'FMDB'</span></span><br><span class="line"><span class="comment">#   end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   tool.subspec 'CommonKits_Tools_UIControls' do |uicontrols|</span></span><br><span class="line"><span class="comment">#     uicontrols.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Tools_UIControls.framework'</span></span><br><span class="line"><span class="comment">#   end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   tool.subspec 'CommonKits_Tools_CoreAnimator' do |db|</span></span><br><span class="line"><span class="comment">#     db.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Tools_CoreAnimator.framework'</span></span><br><span class="line"><span class="comment">#   end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#   tool.subspec 'CommonKits_Tools_MoreTools' do |db|</span></span><br><span class="line"><span class="comment">#     db.vendored_frameworks = 'Example/Carthage/Build/iOS/CommonKits_Tools_MoreTools.framework'</span></span><br><span class="line"><span class="comment">#   end</span></span><br><span class="line"><span class="comment"># end</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p>在<strong>发布源文件包Pod的方式</strong>中是配置各个子组件的<strong>source_files</strong>，定义源码路径；在<strong>发布二进制包Pod的方式</strong>中是配置各个子组件的<strong>vendored_frameworks</strong>，定义打包好的各个子组件的库文件的路径。</p>
<h2 id="Pod组件中Swift和OC混编"><a href="#Pod组件中Swift和OC混编" class="headerlink" title="Pod组件中Swift和OC混编"></a>Pod组件中Swift和OC混编</h2><h3 id="pod中Swift如何引用OC文件"><a href="#pod中Swift如何引用OC文件" class="headerlink" title="pod中Swift如何引用OC文件"></a>pod中Swift如何引用OC文件</h3><ul>
<li>单个工程开发中，Swift引用OC需要添加桥接文件 <em>ProductName-BridgingHeader.h</em> ，然后在桥接文件中导入OC类的头文件即可。添加桥接文件的方式Google。</li>
<li>在Pod的库中，Swift引用OC文件是不需要桥接文件的，因为Pod库会自动生成 <em>ProductName-umbrella.h</em> 文件，运行 <code>pod install</code> 刷新Pod后会自动把OC文件配置在 <em>ProductName-umbrella.h</em> 文件中，Swift就可以使用OC文件。</li>
</ul>
<h3 id="pod中OC如何引用Swift文件"><a href="#pod中OC如何引用Swift文件" class="headerlink" title="pod中OC如何引用Swift文件"></a>pod中OC如何引用Swift文件</h3><ul>
<li>单个工程开发中，OC引用Swift只需要引用Swift类的头文件即可：<code>#import &quot;ProductName-Swift.h&quot;</code>。</li>
<li>在Pod的库中，OC引用Swift文件也需要引用Swift类的头文件，但需要带上Pod的Module：<code>#import &lt;ProductModuleName/ProductName-Swift.h&gt;</code>。</li>
</ul>
<h2 id="Pod组件中资源引入方式"><a href="#Pod组件中资源引入方式" class="headerlink" title="Pod组件中资源引入方式"></a>Pod组件中资源引入方式</h2><p>在上文中已经提及了Pod组件中资源引入是在podspec文件中配置 <strong>resource_bundles</strong> 或者 <strong>resources</strong> 参数来实现的。相比于 <strong>resources</strong> 配置文件路径的方式，<strong>resource_bundles</strong> 是配置字典的方式来指定具体的Bundle，从表象上看这会额外创建一个Bundle来存放指定的资源，更具整理规范性，但实际内部机制也和使用 <strong>resources</strong> 配置方式不同。Cocoapods官方已经不建议使用 <strong>resources</strong> 参数，而是强列推荐使用 <strong>resource_bundles</strong> 配置资源文件，详细原因分析见：<a href="https://vongloo.me/2018/03/17/Pod-Resource/" target="_blank" rel="noopener">Pod 中资源引入方式对比</a>。</p>
<p>可以将图片、Xib等资源存放在Bundle中，使用如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># source_files包含的所有文件会被发布到Cocoapods中，引用的人可以看到这些文件。</span><br><span class="line"># &quot;/**/&quot; 表示所有子文件夹，“*.&#123;文件后缀&#125;” 代表所有符合后缀名的文件，文件路径是基于podspec文件的</span><br><span class="line">spec.source_files  = &quot;WSEducation/WSEducation/**/*.&#123;h,m,swift&#125;&quot;</span><br><span class="line"></span><br><span class="line">spec.resource_bundles = &#123;</span><br><span class="line">  &apos;WSEducationRes&apos; =&gt; [&apos;WSEducation/WSEducation/WSEducation.xcassets&apos;, &apos;WSEducation/WSEducation/**/*.&#123;xib&#125;&apos;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对Pod Framework的Bundle中的资源获取，主要是获取到这个Bundle的的路径，使用正确的Bundle路径才能获取到资源。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// WSEducation 公共方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WSEducation</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 获得resBundle</span></span><br><span class="line">    <span class="meta">@objc</span> <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">resBundle</span><span class="params">()</span></span> -&gt; <span class="type">Bundle?</span> &#123;</span><br><span class="line">        <span class="comment">// 获得Module的Bundle</span></span><br><span class="line">        <span class="keyword">let</span> moduleBundle = <span class="type">Bundle</span>(<span class="keyword">for</span>: <span class="type">WSEducation</span>.<span class="keyword">self</span>)</span><br><span class="line">        <span class="comment">// 获得Module的资源Bundle的路径</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> resBundleUrl = moduleBundle.url(forResource: <span class="string">"WSEducationRes"</span>, withExtension: <span class="string">"bundle"</span>) <span class="keyword">else</span> &#123; <span class="keyword">return</span> moduleBundle &#125;</span><br><span class="line">        <span class="comment">// 获得Module的资源Bundle</span></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> resBundle = <span class="type">Bundle</span>(url: resBundleUrl) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> resBundle</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获取VC</span></span><br><span class="line"><span class="keyword">let</span> <span class="type">VC</span> = <span class="type">TestViewController</span>(nibName: <span class="string">"TestViewController"</span>, bundle: <span class="type">WSEducation</span>.resBundle())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取图片</span></span><br><span class="line">imageView.image = <span class="type">UIImage</span>(named: <span class="string">"WSCommonAliIcon"</span>, <span class="keyword">in</span>: <span class="type">WSEducation</span>.resBundle(), compatibleWith: <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取Xib</span></span><br><span class="line"><span class="keyword">self</span>.controlViewForEmbedded = <span class="type">EasyPlayerUtils</span>.resBundle()!.loadNibNamed(<span class="type">String</span>(describing: <span class="type">EasyPlayerControlView</span>.<span class="keyword">self</span>), owner: <span class="literal">nil</span>, options: <span class="literal">nil</span>)?.first <span class="keyword">as</span>? <span class="type">EasyPlayerControlView</span></span><br></pre></td></tr></table></figure>
<h2 id="Pod组件的解耦"><a href="#Pod组件的解耦" class="headerlink" title="Pod组件的解耦"></a>Pod组件的解耦</h2><p>建立Pod组件工程的思想是：<strong>基础组件无耦合，业务组件进行解耦</strong>。解耦我们使用Target-Action方案，工具使用 <strong>CTMediator</strong>，这里进行简单的思路分析和使用说明。</p>
<h3 id="调用方式"><a href="#调用方式" class="headerlink" title="调用方式"></a>调用方式</h3><ul>
<li>整体架构组件化方案分为两种调用方式，远程调用和本地调用，对于两个不同的调用方式分别对应两个接口。</li>
<li>远程调用通过AppDelegate代理方法传递到当前应用后，调用远程接口并在内部做一些处理，处理完成后会在远程接口内部调用本地接口，以实现本地调用为远程调用服务。</li>
<li>本地调用由performTarget:action:params:方法负责，但调用方一般不直接调用performTarget:方法。CTMediator会对外提供明确参数和方法名的方法，在方法内部调用performTarget:方法和参数的转换。</li>
</ul>
<h3 id="架构设计思路"><a href="#架构设计思路" class="headerlink" title="架构设计思路"></a>架构设计思路</h3><ul>
<li>通过CTMediator类实现组件化，在此类中对外提供明确参数类型的接口，接口内部通过performTarget方法调用服务方组件的Target、Action。</li>
<li>由于CTMediator类的调用是通过runtime主动发现服务的，所以服务方对此类是完全解耦的。</li>
<li>但如果CTMediator类对外提供的方法都放在此类中，将会对CTMediator造成极大的负担和代码量。</li>
<li>解决方法就是对每个服务方组件创建一个CTMediator的Category（OC）或Extension（Swift），并将对服务方的performTarget调用放在对应的Category和Extension中，这些Category和Extension都属于CTMediator中间件，从而实现了感官上的接口分离。</li>
</ul>
<h3 id="组件化实现细节"><a href="#组件化实现细节" class="headerlink" title="组件化实现细节"></a>组件化实现细节</h3><ul>
<li>对于服务方的组件来说，每个组件都提供一个或多个Target类，在Target类中声明Action方法。</li>
<li>Target类是当前组件对外提供的一个“服务类”，Target将当前组件中所有的服务都定义在里面，CTMediator通过runtime主动发现服务。</li>
<li>在Target中的所有Action方法，都只有一个字典参数，所以可以传递的参数很灵活，这也是casatwy提出的去Model化的概念。</li>
<li>在Action的方法实现中，对传进来的字典参数进行解析，再调用组件内部的类和方法。</li>
</ul>
<h3 id="CTMediator组件化使用说明"><a href="#CTMediator组件化使用说明" class="headerlink" title="CTMediator组件化使用说明"></a>CTMediator组件化使用说明</h3><p>以播放器组件 <strong><code>EasyPlayer</code></strong> 为例，它的对外接口组件是 <strong><code>EasyPlayer_Extension</code></strong>，通过这个对外接口组件使用 <strong><code>EasyPlayer</code></strong> 。具体实现如下：</p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-01_4_48_43.png" alt="2019-04-01_4_48_43"></p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-01_4_45_02.png" alt="2019-04-01_4_45_02"></p>
<p><img src="/images/Cocoapods实现iOS组件化之Pod打包Framework方式/2019-04-01_4_47_31.png" alt="2019-04-01_4_47_31.png"></p>
<h2 id="Pod组件打包和发布"><a href="#Pod组件打包和发布" class="headerlink" title="Pod组件打包和发布"></a>Pod组件打包和发布</h2><p>在开发和调试阶段，需要使用podspec文件中的 <strong>发布源文件包的方式</strong> 才能看到源码；在准备发布时则需要注释podspec文件中的 <strong>发布源文件包的方式</strong> ，放开对 <strong>发布二进制包Pod的方式</strong> 的注释，再运行组件工程中的 <em>upload.sh</em> 文件来发布二进制包形式的Pod库。</p>
<h2 id="私有组件库Pod-Search"><a href="#私有组件库Pod-Search" class="headerlink" title="私有组件库Pod Search"></a>私有组件库Pod Search</h2><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><blockquote>
<p><a href="https://casatwy.com/modulization_in_action.html" target="_blank" rel="noopener">在现有工程中实施基于CTMediator的组件化方案</a></p>
<p><a href="https://casatwy.com/iOS-Modulization.html" target="_blank" rel="noopener">iOS应用架构谈 组件化方案</a></p>
<p><a href="https://vongloo.me/2018/03/17/Pod-Resource/" target="_blank" rel="noopener">Pod 中资源引入方式对比</a></p>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Nevermore</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://nevermoregodlike.github.io/2019/03/25/Cocoapods实现iOS组件化之Pod打包Framework方式/">https://nevermoregodlike.github.io/2019/03/25/Cocoapods实现iOS组件化之Pod打包Framework方式/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://nevermoregodlike.github.io">Nevermore's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/组件化/">组件化</a><a class="post-meta__tags" href="/tags/Cocoapods/">Cocoapods</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://i.loli.net/2019/04/02/5ca30e69897a8.jpg"><div class="post-qr-code__desc">微信打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://i.loli.net/2019/04/02/5ca30e7dcbe6c.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div></div><div class="addthis_inline_share_toolbox pull-right"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5ca32f17eca84b9b" async></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/04/26/Cocoapods实现iOS组件化之友盟Pod库封装/"><i class="fa fa-chevron-left">  </i><span>Cocoapods实现iOS组件化之友盟Pod库封装</span></a></div><div class="next-post pull-right"><a href="/2019/03/18/Cocoapods实现iOS组件化之自建Framework方式（下）/"><span>Cocoapods实现iOS组件化之自建Framework方式（下）</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'true' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'https://nevermoregodlike.github.io'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'unBqQpHxu88bs3oDBq2zCClu-gzGzoHsz',
  appKey:'hOArQ82278lxPybqL349GBWG',
  placeholder:'Just go go',
  avatar:'mp',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/04/02/5ca30d6813aa1.png)"><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2019 By Nevermore</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>